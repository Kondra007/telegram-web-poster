<html>
<head>
	<title>Telegram poster</title>
	<link rel="shortcut icon" type="image/png" href="favicon.png">
	<meta property="og:title" content="Telegram Channels Web Poster" />
	<meta property="og:description" content="A simpliest WYSIWIG Telegram channels poster" />
	<link rel="stylesheet" href="css/style.css"> <!-- Main theme -->
	<link rel="stylesheet" href="css/medium-editor.min.css"> <!-- Core -->
	<link rel="stylesheet" href="css/themes/bootstrap.min.css"> <!-- or any other theme -->
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
	<script src="js/medium-editor.js"></script>
	<script src="js/MediumButton.min.js"></script>
</head>
<body>
<a target="_blank" href="https://github.com/nicecoderr/telegram-web-poster"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>
<div id="container">
	<h2>Telegram poster</h2>
	<div class="editable"></div>
	Message_id (for editing): <input type="text" id="edit_msg" name="edit_msg"><br />
	Bot token: <input type="text" id="token" name="token" value="" size="56"><br />
	Channel name or id: <input type="text" id="txt" name="chat_id" value=""><br />
	Hidden image (leave blank to disable) <input type="text" id="hid_img" value="" size="80"><br />
	<input type="checkbox" checked="checked" id="notif"/> Disable notifications <br />
	<input type="checkbox" id="preview"/> Disable webpage preview (removes hidden image if any) <br />
	<input value="Send post" id="btn" type="button"> 
	<input value="Clear text" id="clr_txt" type="button">
</div>
<script>
var editor = new MediumEditor('.editable', {
	placeholder: {
        text: 'Type your text',
        hideOnClick: true
    },
	toolbar: {
        buttons: [
            'bold',
            'italic',
			'anchor',
			'pre',
			'inline_code',
        ]
    },
	extensions: {
		'inline_code': new MediumButton({label:'<b>inline code</b>', start:'<code>', end:'</code>'}),
		'pre': new MediumButton({label:'<b>block code</b>', start:'<pre>', end:'</pre>'})
	},
    activeButtonClass: 'medium-editor-button-active',
	disableReturn: false,
    spellcheck: false,
	targetBlank: true,
});

$("#clr_txt").click(function() {$(".editable").html("");});
$("#btn").click(snd)

function snd(){
  var url = "https://api.telegram.org/bot" + $("#token").val();
  url += $("#edit_msg").val() ? '/editMessageText' : '/sendMessage';
  var message = $("div.editable").html().slice(3, -4).replace(/<\/p>/g, '\n\n')
  .replace(/<p>/g, '').replace(/<br>/g, '\n').replace(/&nbsp;/g, ' ');
  console.log(message);
  
  $.ajax({
    url: url,
	headers: {'Content-type': 'application/x-www-form-urlencoded'},
    data: {
      chat_id: $("#txt").val(),
      text: $("#hid_img").val() ? "<a href=\""+$("#hid_img").val()+"\">&#8203;</a>&#8203;" + message : message,
      parse_mode: 'HTML',
      message_id: $("#edit_msg").val(),
      disable_notification: $("#notif").prop('checked'),
      disable_web_page_preview: $("#preview").prop('checked')
    }
  });
}


</script>
</body>
</html>
